define("chartx/chart/map/tips",["canvax/index","canvax/shape/Circle","chartx/components/tips/tip","canvax/shape/Polygon","canvax/animation/Tween","chartx/utils/deep-extend"],function(a,b,c,d,e){var f=function(a,b,c){this.sprite=null,this._triangle=null,this._tip=null,this.mapScale=1,this.cPointStyle="white",this._nearestPoint=null,this._thirdPoint=null,this._tween=null,this.init(a,b,c)};return f.prototype={init:function(b,d,e){_.deepExtend(this,b),this.sprite=new a.Display.Sprite({id:"tips"}),b=_.deepExtend({prefix:d.field,context:"\u4e2d\u56fd\u5730\u56fe"},b),this._tip=new c(b,e)},show:function(a){this.sprite.addChild(this._tip.sprite),this._tip.show(a),this._weight(a),this._tip.sprite.toFront(),this.sprite.toFront(),this._triangle.context.globalAlpha=.7},move:function(a){this._tip.move(a)},hide:function(a){this._tip.hide(a),this._cPoint.remove(),this._triangle.context.globalAlpha=0},_weight:function(a){function c(){n=requestAnimationFrame(c),e.update()}var f=[a.target.mapData.cx*this.mapScale,a.target.mapData.cy*this.mapScale];this._cPoint=new b({context:{x:f[0],y:f[1],r:3,fillStyle:this.cPointStyle}}),this.sprite.addChild(this._cPoint);var g="left";f[0]<560*this.mapScale/2&&(g="right");var h=80,i=[f[0]+Math.cos(-Math.PI*("left"==g?3:2)/5)*h,f[1]+Math.sin(-Math.PI*("left"==g?3:2)/5)*h];i[1]<0&&(i[1]=2);var j=this._tip.dW,k=this._tip.dH,l=[i[0]+("left"==g?-j:j),i[1]+k];if(i[1]+=this._tip.backR,this._thirdPoint&&this._nearestPoint){var m=this,n=null;m._tween&&m._tween.stop();var o=function(){m._tween=new e.Tween({n0:m._nearestPoint[0],n1:m._nearestPoint[1]}).to({n0:i[0],n1:i[1]},500).easing(e.Easing.Exponential.Out).onUpdate(function(){m._nearestPoint[0]=this.n0,m._nearestPoint[1]=this.n1,m._thirdPoint[0]=this.n0+("left"==g?-j:j),m._thirdPoint[1]=this.n1+k,m._triangle.context.pointList=[f,m._nearestPoint,m._thirdPoint];var a=m.sprite.localToGlobal({x:"left"==g?m._thirdPoint[0]:m._nearestPoint[0],y:m._nearestPoint[1]});m._tip.setPosition({pos:a})}).onComplete(function(){cancelAnimationFrame(n),m._tween=null}).start(),c()};o()}else{this._triangle=new d({context:{pointList:[f,i,l],fillStyle:"white",globalAlpha:.7}}),this.sprite.addChild(this._triangle),this._thirdPoint=l,this._nearestPoint=i;var p=this.sprite.localToGlobal({x:"left"==g?l[0]:i[0],y:i[1]});this._tip.setPosition({pos:p})}}},f});