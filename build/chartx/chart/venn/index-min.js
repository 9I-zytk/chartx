define("chartx/chart/venn/index",["chartx/chart/index","canvax/shape/Circle","chartx/layout/venn/index","chartx/utils/colorformat","chartx/components/tips/tip"],function(a,b,c,d,e){var f=a.Canvax;return a.extend({init:function(a,b,c){this.colors=["#fa8529","#2494ed","#7aa1ff","#42a8d7","#666666","#7aa1ff"],this.padding=15,this.nodeField="sets",this.valueField="size",this.labelField="label",this.text={enabled:0,fillStyle:null,fontSize:18,textAlign:"center",textBaseline:"middle",format:null},this.circle={fillAlpha:.25,fillStyle:null,strokeStyle:null,lineWidth:2},_.deepExtend(this,c),this.data=this._initData(_.clone(b))},_initData:function(a){var b=[],c=this,d=a.shift(0);return _.each(a,function(a){var e={};_.each(d,function(b,d){if(b==c.nodeField){var f=a[d];_.isArray(f)||(f=[f]),e.sets=f}else b==c.valueField?e.size=a[d]:b==c.labelField?e.label=a[d]:e[b]=a[d]}),b.push(e)}),b},draw:function(){this.stageTip=new f.Display.Sprite({id:"tip"}),this.core=new f.Display.Sprite({id:"core"}),this.stage.addChild(this.core),this.stage.addChild(this.stageTip),this._initModule(),this._startDraw(),this._drawEnd()},_initModule:function(){this._tip=new e(this.tips,this.canvax.getDomContainer()),this._tip._getDefaultContent=this._getTipDefaultContent},_getColor:function(a,b,c){if(_.isString(a))return a;if(_.isArray(a))return a[b];if(_.isFunction(a)){var d=a.apply(this,[b,c]);if(d)return d}return this.colors[b]},_getValue:function(a){var b=null;return _.each(this.data,function(c){1==c.sets.length&&c.sets[0]==a&&(b=c.size)}),b},getLabel:function(a){var b=null;return _.each(this.data,function(c){c.sets.join(",")==a&&c.label&&(b=c.label)}),b},_startDraw:function(){var a=this;!function(e){"use strict";function g(a,b,c){var d,f,g=b[0].radius-e.distance(b[0],a);for(d=1;d<b.length;++d)f=b[d].radius-e.distance(b[d],a),g>=f&&(g=f);for(d=0;d<c.length;++d)f=e.distance(c[d],a)-c[d].radius,g>=f&&(g=f);return g}function h(a,b){var c,d=[];for(c=0;c<a.length;++c){var f=a[c];d.push({x:f.x,y:f.y}),d.push({x:f.x+f.radius/2,y:f.y}),d.push({x:f.x-f.radius/2,y:f.y}),d.push({x:f.x,y:f.y+f.radius/2}),d.push({x:f.x,y:f.y-f.radius/2})}var h=d[0],i=g(d[0],a,b);for(c=1;c<d.length;++c){var j=g(d[c],a,b);j>=i&&(h=d[c],i=j)}var k=e.fmin(function(c){return-1*g({x:c[0],y:c[1]},a,b)},[h.x,h.y],{maxIterations:500,minErrorDelta:1e-10}).solution,l={x:k[0],y:k[1]},m=!0;for(c=0;c<a.length;++c)if(e.distance(l,a[c])>a[c].radius){m=!1;break}for(c=0;c<b.length;++c)if(e.distance(l,b[c])<b[c].radius){m=!1;break}if(!m)if(1==a.length)l={x:a[0].x,y:a[0].y};else{var n={};e.intersectionArea(a,n),l=0===n.arcs.length?{x:0,y:-1e3,disjoint:!0}:e.getCenter(n.arcs.map(function(a){return a.p1}))}return l}function i(a,b){for(var c={},d=0;d<b.length;++d){for(var e=b[d].sets,f={},g=0;g<e.length;++g)f[e[g]]=!0;var i=[],j=[];for(var k in a)k in f?i.push(a[k]):j.push(a[k]);var l=h(i,j);c[e]=l,l.disjoint&&b[d].size>0}return c}e.VennDiagram=function(){var e=Math.PI/2,g=!0,h=c.venn(a.data);g&&(h=c.normalizeSolution(h,e));var j=c.scaleSolution(h,a.width,a.height,a.padding),k=i(j,a.data),l=0;for(var m in j){var n=j[m];if(n.radius){var o=d.colorRgb(a._getColor(a.circle.fillStyle,l,m)),p=a._getColor(a.circle.strokeStyle,l,m),q=new b({context:{x:n.x,y:n.y,r:n.radius,fillStyle:o.replace(")",","+a.circle.fillAlpha+")").replace("RGB","RGBA"),strokeStyle:p,lineWidth:a.circle.lineWidth}});q.index=l,q.name=m,a.core.addChild(q),q.hover(function(b){var c=d.colorRgb(a._getColor(a.circle.fillStyle,this.index,this.name)),e=c.replace(")",","+(a.circle.fillAlpha+.1)+")").replace("RGB","RGBA");this.context.fillStyle=e,b.tipsInfo=a._getInfoHandler(this,b),a._tip.show(b)},function(b){var c=d.colorRgb(a._getColor(a.circle.fillStyle,this.index,this.name)),e=c.replace(")",","+a.circle.fillAlpha+")").replace("RGB","RGBA");this.context.fillStyle=e,a._tip.hide(b)}),q.on("mousemove",function(b){b.tipsInfo=a._getInfoHandler(this,b),a._tip.move(b)}),l++}}l=0;for(var r in k){if(r.indexOf(",")<0&&!isNaN(k[r].x)){var s=k[r],t=a.getLabel(r)||r,o=a._getColor(a.text.fillStyle,l,r),u=new f.Display.Text(t,{context:{x:s.x,y:s.y,fillStyle:o,fontSize:a.text.fontSize,textAlign:a.text.textAlign,textBaseline:a.text.textBaseline}});a.core.addChild(u)}l++}},e.computeTextCentre=h,e.computeTextCentres=i}(c),c.VennDiagram()},_getTipDefaultContent:function(a){return"<div style='color:#ffffff'><div style='padding-bottom:3px;'>"+a.name+"ï¼š"+a.value+"</div></div>"},_getInfoHandler:function(a){var b={iNode:a.index,name:a.name,value:this._getValue(a.name),fillStyle:a.context.strokeStyle};return b},_drawEnd:function(){this.stageTip.addChild(this._tip.sprite)}})});