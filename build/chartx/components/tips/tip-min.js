define("chartx/components/tips/tip",["canvax/index","canvax/shape/Rect","chartx/utils/deep-extend"],function(a,b){var c=function(a,b){this.tipDomContainer=b,this.cW=0,this.cH=0,this.dW=0,this.dH=0,this.backR=3,this.sprite=null,this.content=null,this._tipDom=null,this._back=null,this.tipsInfo={},this.prefix=[],this.init(a)};return c.prototype={init:function(b){_.deepExtend(this,b),this.sprite=new a.Display.Sprite({id:"TipSprite"})},show:function(a){this.hide();var b=a.target.getStage();this.cW=b.context.width,this.cH=b.context.height,this._initContent(a),this._initBack(a),this.setPosition(a),this.sprite.toFront()},move:function(a){this._setContent(a),this._resetBackSize(a),this.setPosition(a)},hide:function(){this.sprite.removeAllChildren(),this._removeContent()},setPosition:function(a){if(this._tipDom){var b=a.pos||a.target.localToGlobal(a.point),c=this._checkX(b.x),d=this._checkY(b.y),e=this.sprite.parent.globalToLocal({x:c,y:d});this.sprite.context.x=e.x,this.sprite.context.y=e.y,this._tipDom.style.cssText+=";visibility:visible;left:"+c+"px;top:"+d+"px;"}},_initContent:function(a){this._tipDom=document.createElement("div"),this._tipDom.className="chart-tips",this._tipDom.style.cssText+=";visibility:hidden;position:absolute;display:inline-block;*display:inline;*zoom:1;padding:6px;",this.tipDomContainer.appendChild(this._tipDom),this._setContent(a)},_removeContent:function(){this._tipDom&&(this.tipDomContainer.removeChild(this._tipDom),this._tipDom=null)},_setContent:function(a){this._tipDom&&(this._tipDom.innerHTML=this._getContent(a),this.dW=this._tipDom.offsetWidth,this.dH=this._tipDom.offsetHeight)},_getContent:function(a){_.deepExtend(this.tipsInfo,a.tipsInfo||{});var b=_.isFunction(this.content)?this.content(this.tipsInfo):this.content;return b||(b=this._getDefaultContent(this.tipsInfo)),b},_getDefaultContent:function(a){var b="<table>",c=this;return _.each(a.nodesInfoList,function(a,d){b+="<tr style='color:"+(a.color||a.fillStyle)+"'>";var e=c.prefix[d];e&&(b+="<td>"+e+"\uff1a</td>"),b+="<td>"+a.value+"</td></tr>"}),b+="</table>"},_initBack:function(){var a={x:0,y:0,width:this.dW,height:this.dH,lineWidth:1,strokeStyle:"#333333",fillStyle:"#ffffff",radius:[this.backR]};this._back=new b({id:"tipsBack",context:a}),this.sprite.addChild(this._back)},_resetBackSize:function(){this._back.context.width=this.dW,this._back.context.height=this.dH},_checkX:function(a){var b=this.dW+2;return 0>a&&(a=0),a+b>this.cW&&(a=this.cW-b),a},_checkY:function(a){var b=this.dH+2;return 0>a&&(a=0),a+b>this.cH&&(a=this.cH-b),a}},c});