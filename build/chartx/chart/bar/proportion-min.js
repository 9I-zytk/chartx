define("chartx/chart/bar/proportion",["chartx/chart/bar/index","chartx/utils/tools"],function(a,b){return a.extend({init:function(a,c,d){this._opts=d,!d.tips&&(d.tips={}),d.tips=_.deepExtend(d.tips,{content:function(a){var c="<table>",d=this;return _.each(a.nodesInfoList,function(a,e){c+="<tr style='color:"+d.text.fillStyle+"'>";var f=d.prefix[e];f?c+="<td>"+f+"：</td>":a.field&&(c+="<td>"+a.field+"：</td>"),c+="<td>"+b.numAddSymbol(a.value)+"（"+Math.round(a.value/a.vCount*100)+"%）</td></tr>"}),c+="</table>"}}),_.deepExtend(this,d),_.deepExtend(this.yAxis,{dataSection:[0,20,40,60,80,100],text:{format:function(a){return a+"%"}}}),!this.graphs&&(this.graphs={}),_.deepExtend(this.graphs,{bar:{radius:0}}),this.dataFrame=this._initData(c)},_trimGraphs:function(a,b){a||(a=this._xAxis),b||(b=this._yAxis);var c=a.data,d=b.dataOrg,e=d.length,f=a.xDis1,g=f/(e+1);this._graphs.checkBarW&&this._graphs.checkBarW(g);for(var h=b.dataSection[b.dataSection.length-1],i=[],j=[],k=[],l=[],m=0;e>m;m++)!i[m]&&(i[m]=[]),k[m]=0,j[m]={},_.each(d[m],function(a,e){!i[m][e]&&(i[m][e]=[]),_.each(a,function(h,j){if(c[j]){var n=0;_.each(d[m],function(a,b){n+=a[j]});var o=c[j].x-f/2+g*(m+1),p=-h/n*b.yGraphsHeight;e>0&&(p+=i[m][e-1][j].y),i[m][e].push({value:h,vCount:n,x:o,y:p}),k[m]+=Number(h),l=a.length}})});for(var n=0,o=k.length;o>n;n++)j[n].agValue=k[n]/l,j[n].agPosition=-(k[n]/l-b._bottomNumber)/(h-b._bottomNumber)*b.yGraphsHeight;return this.dataFrame.yAxis.center=j,{data:i}}})});